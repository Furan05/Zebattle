<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>üèÜ Tournois Groudonbattle</h1>
    <div>
      <div class="btn-group" role="group">
        <%= form_with url: generate_auto_tournament_path, method: :post, local: true, class: 'd-inline' do |form| %>
          <%= form.submit 'Tournoi Classique', class: 'btn btn-success', title: 'G√©n√©ration avec noms pr√©d√©finis' %>
        <% end %>
        <%= form_with url: generate_faker_tournament_path, method: :post, local: true, class: 'd-inline' do |form| %>
          <%= form.submit 'Tournoi Faker üé≤', class: 'btn btn-primary', title: 'G√©n√©ration avec noms al√©atoires cr√©atifs' %>
        <% end %>
      </div>
      <%= link_to 'G√©rer les √©quipes', teams_path, class: 'btn btn-secondary ms-2' %>
    </div>
  </div>

  <!-- Statistiques rapides -->
  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card bg-primary text-white">
        <div class="card-body text-center">
          <h4><%= Team.count %></h4>
          <p class="mb-0">√âquipes totales</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-success text-white">
        <div class="card-body text-center">
          <h4><%= @complete_teams %></h4>
          <p class="mb-0">√âquipes compl√®tes</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-info text-white">
        <div class="card-body text-center">
          <h4><%= Player.count %></h4>
          <p class="mb-0">Joueurs totaux</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-warning text-white">
        <div class="card-body text-center">
          <h4><%= @tournaments.count %></h4>
          <p class="mb-0">Tournois organis√©s</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Explication des modes de g√©n√©ration -->
  <div class="card mb-4">
    <div class="card-header">
      <h5 class="mb-0">üéÆ Modes de g√©n√©ration de tournois</h5>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <h6>üéØ Mode Classique</h6>
          <ul class="small">
            <li><strong>√âquipes :</strong> Dragons de Feu, Titans de Glace, etc.</li>
            <li><strong>Joueurs :</strong> Aragorn le Brave, Legolas l'Intr√©pide</li>
            <li><strong>Style :</strong> Fantasy m√©di√©val coh√©rent</li>
          </ul>
        </div>
        <div class="col-md-6">
          <h6>üé≤ Mode Faker</h6>
          <ul class="small">
            <li><strong>√âquipes :</strong> Noms compl√®tement al√©atoires et cr√©atifs</li>
            <li><strong>Joueurs :</strong> M√©langes de fantasy, superh√©ros, jeux vid√©o</li>
            <li><strong>Style :</strong> Surprenant et vari√© √† chaque g√©n√©ration</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Alerte si pas assez d'√©quipes -->
  <% if @complete_teams < 8 %>
    <div class="alert alert-info">
      <h5>üí° G√©n√©ration automatique disponible</h5>
      <p class="mb-0">
        Vous avez actuellement <strong><%= @complete_teams %></strong> √©quipe(s) compl√®te(s).
        Les g√©n√©rateurs automatiques cr√©eront 8 nouvelles √©quipes compl√®tes pour un tournoi instantan√© !
        Choisissez entre le <strong>mode Classique</strong> (th√®me fantasy) ou le <strong>mode Faker</strong> (noms al√©atoires cr√©atifs).
      </p>
    </div>
  <% end %>

  <!-- Liste des tournois -->
  <% if @tournaments.any? %>
    <h3>Tournois organis√©s</h3>
    <% @tournaments.each do |tournament| %>
      <div class="card mb-4">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h4 class="mb-0">
            <%= link_to tournament.name, tournament, class: 'text-decoration-none' %>
          </h4>
          <div>
            <span class="badge bg-<%= tournament.status == 'completed' ? 'success' : 'warning' %> fs-6">
              <%= tournament.status == 'completed' ? 'Termin√©' : 'En cours' %>
            </span>
            <small class="text-muted ms-2">
              <%= tournament.created_at.strftime('%d/%m/%Y √† %H:%M') %>
            </small>
          </div>
        </div>

        <% if tournament.status == 'completed' %>
          <div class="card-body">
            <div class="row">
              <div class="col-md-6">
                <h6>ü•á Top 3 du tournoi</h6>
                <% tournament.ranking.first(3).each_with_index do |(team, stats), index| %>
                  <div class="d-flex justify-content-between align-items-center py-1">
                    <span>
                      <%= ['ü•á', 'ü•à', 'ü•â'][index] %>
                      <%= team.name %>
                    </span>
                    <span class="badge bg-primary"><%= stats[:points] %> pts</span>
                  </div>
                <% end %>
              </div>
              <div class="col-md-6">
                <h6>üìä Statistiques</h6>
                <small class="text-muted">
                  ‚Ä¢ <%= tournament.matches.count %> matchs jou√©s<br>
                  ‚Ä¢ <%= tournament.matches.sum(:team1_score) + tournament.matches.sum(:team2_score) %> kills au total<br>
                  ‚Ä¢ <%= tournament.ranking.count %> √©quipes participantes
                </small>
              </div>
            </div>
            <div class="text-end mt-2">
              <%= link_to 'Voir les d√©tails', tournament, class: 'btn btn-outline-primary btn-sm' %>
            </div>
          </div>
        <% else %>
          <div class="card-body">
            <p class="text-muted mb-0">Tournoi en pr√©paration...</p>
          </div>
        <% end %>
      </div>
    <% end %>
  <% else %>
    <div class="text-center py-5">
      <h3 class="text-muted">Aucun tournoi organis√©</h3>
      <p class="text-muted mb-4">Cr√©ez votre premier tournoi pour voir les √©quipes s'affronter !</p>

      <div class="row justify-content-center">
        <div class="col-md-6">
          <div class="card">
            <div class="card-body">
              <h5>üéØ Tournoi Classique</h5>
              <p class="small text-muted">√âquipes avec th√®mes fantasy pr√©d√©finis</p>
              <%= form_with url: generate_auto_tournament_path, method: :post, local: true, class: 'd-inline' do |form| %>
                <%= form.submit 'G√©n√©rer Tournoi Classique', class: 'btn btn-success' %>
              <% end %>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="card">
            <div class="card-body">
              <h5>üé≤ Tournoi Faker</h5>
              <p class="small text-muted">√âquipes et joueurs compl√®tement al√©atoires</p>
              <%= form_with url: generate_faker_tournament_path, method: :post, local: true, class: 'd-inline' do |form| %>
                <%= form.submit 'G√©n√©rer Tournoi Faker', class: 'btn btn-primary' %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>
